<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>MexIFace: README.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MexIFace
   </div>
   <div id="projectbrief">A C++/Matlab object-based interface library and cross-platform CMake MEX build tool.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">README.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="README_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;&lt;a href=&quot;https://travis-ci.org/markjolah/MexIFace&quot;&gt;&lt;img src=&quot;https://travis-ci.org/markjolah/MexIFace.svg?branch=master&quot;/&gt;&lt;/a&gt;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# MexIFace</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;A C++/Matlab object-based interface library and cross-platform CMake build system for creating interactive Matlab MEX modules with persistent state and complex behavior.</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;## About</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;&lt;img align=&quot;right&quot; width=&quot;450px&quot; alt=&quot;MexIFace diagram&quot; src=&quot;http://raw.github.com/markjolah/MexIFace/master/doc/images/mexiface_diagram.png&quot;&gt;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;The [`MexIFace`](https://markjolah.github.io/MexIFace/classmexiface_1_1MexIFace.html) class provides a flexible means of wrapping a complex C++ library into a Matlab class via Matlab&#39;s [MEX function](https://www.mathworks.com/help/matlab/call-mex-files-1.html) extension method.  A standard Matlab MEX module implements a single function API, with no obvious way to manage shared state across one or more interacting MEX components.  A MexIFace generated MEX module is wrapped in a regular [Matlab handle class](https://www.mathworks.com/help/matlab/handle-classes.html) interface with normal Matlab properties and methods.  MexIFace Matlab objects have associated C++ state that is persistent across method calls into the MEX module.</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Instead of the procedural workflow implied by the static `mexFunction()` interface, a MexIFace wrapped class can be used interactively.  Multiple objects of the wrapped type can be created and accessed independently using the same MEX module.  Each instantiated object has its own persistent state; and when Matlab garbage collects a MexIFace object, it&#39;s C++ resources are freed as well.</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;### Other important features:</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;* A MexIFace wrapper can be created for any C++ class(es) without requiring any changes to the C++ library itself.</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;* MexIFace provides transparent (i.e., no-copy) access to Matlab [`mxArray`](https://www.mathworks.com/help/matlab/apiref/mxarray.html) objects as C++ [Armadillo](http://arma.sourceforge.net/) objects.  This makes it possible to directly share multidimensional array data.  (see: [Armadillo and mxArrays](#armadillo-and-mxArrays))</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;* The CMake build system manages correctly linking to the 64-bit integer BLAS and LAPACK libraries required by Matlab, and enables the armadillo BLAS and LAPACK integration. (See: [BLAS and LAPACK](#blas-and-lapack))</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;* Parallelization for C++ code can easily be implemented with [OpenMP](https://www.openmp.org/specifications/).</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;* Supports for C++11/14/17 is possible depending on the Matlab release targeted (see: [Matlab and MEX linking](#matlab-and-mex-linking))</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;* The MexIFace CMake build system can cross-compile from Linux hosts to target Matlab Linux (`glnxa64`) and Windows (`win64`) environments</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    * See: [Cross-compiling to Linux Targets](#cross-compiling-to-linux-targets)</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    * See: [Cross-compiling to Windows Targets](#cross-compiling-to-windows-targets)</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;### Quick Start</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  * [MexIFace-ArmadilloExample](https://github.com/markjolah/MexIFace-ArmadilloExample) - A fully functional MexIFace module that demonstrates the MexIFace C++ and Matlab interfaces, as well as the suggested CMake build environment, and github repository layout.</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;## Documentation</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;The MexIFace Doxygen documentation can be build with the `OPT_DOC` CMake option and is also available online:</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  * [MexIFace HTML Manual](https://markjolah.github.io/MexIFace/index.html)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  * [MexIFace PDF Manual](https://markjolah.github.io/MexIFace/doc/MexIFace-0.2-reference.pdf)</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  * [MexIFace github repository](https://github.com/markjolah/MexIFace)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;## Motivation</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;Matlab uses compiled plugins called MEX files to enable linking and running C and C++ code.  A MEX file is a shared object file (ELF on Linux and DLL on Windows) that is dynamically loaded by the Matlab binary when the function it names is called.  Each MEX file presents to Matlab an interface consisting of exactly one function with variable input and output arguments.</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;~~~Matlab</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;function varargout = mexFunction(varargin)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;~~~</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;Separate MEX functions have no direct way to communicate with this API, and as C and C++ libraries become more complex this isolated, static function interface becomes increasingly restrictive.</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;Complex simulations an analysis libraries have more demanding requirements; they must:</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; * manage persistent state</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; * provide multiple functions that interact with that state</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; * require coordination with Matlab to manage shared data(memory)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; * require initialization at load time</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; * require cleanup when their data is no longer needed</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; * may require the creation of multiple independent realizations with independent state</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;In other words, **complex libraries are much more like objects than functions**.  An object-oriented MEX file interface provides an easier, safer, faster, and more organized way of interacting with complex C++ libraries from Matlab.</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;### Armadillo and mxArrays</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;MexIFace uses the [Armadillo](http://arma.sourceforge.net/docs.html) package to provide an efficient and powerful C++ interface to Matlab array types.  Passing and returning large array data between C++ and Matlab can be very inefficient if data needs to be copied repeatedly.  The Armadillo [auxillary-memory constructors](http://arma.sourceforge.net/docs.html#Mat) allow C++ Armadillo arrays to transparently manipulate Matlab `mxArray` raw data, as both use [column-major](https://en.wikipedia.org/wiki/Row-_and_column-major_order) layouts.</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;This allows the same memory allocated by Matlab to be used in C++ with very little overhead incurred when passing large array arguments.  Return arguments can also be allocated from C++ into Matlab managed memory using Matlab&#39;s `mxArray` API, then mapped directly to an Armadillo C++ array used as output.</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;The mexiface::MexIFace class implements templated methods to succinctly convert data views between `mxArray` and armadillo array data types,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;~~~.cpp</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;mxArray *matlab_vec, *matlab_mat, *matlab_cube;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;...</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;//Interpreting matlab arrays as armadillo arrays</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;arma::vec cxx_vec = getVec(matlab_vec);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;arma::mat cxx_mat = getMat(matlab_mat);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;arma::cube cxx_cube = getCube(matlab_cube);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;//Writing armadillo arrays to new matlab mxArrays</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;mxArray *out_vec = toMXArray(cxx_vec)</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;mxArray *out_mat = toMXArray(cxx_mat)</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;mxArray *out_cube = toMXArray(cxx_cube)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;//Creating an output matlab array buffer to write into</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;//Each armadillo array points to matlab mxArray memory</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;arma::vec buf_vec = makeOutputArray(nelem);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;arma::mat buf_mat = makeOutputArray(nrows,ncols);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;arma::cube buf_cube = makeOutputArray(nrows,ncols,nslices);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;~~~</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;# Building and Installing</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; MexIFace uses the `MATLAB_ROOT` and `MATLAB_ROOTS` environment variables to find Matlab installations.  For each Matlab release found, the build system creates a CMake`MexIFace::MexIFaceX_Y` target corresponding to a `libMexIFaceX_Y.so` library, where `X_Y` is the numerical release code for each Matlab as returned by Matlab `version` command.  Each Matlab release has potentially incompatible dependency and linking requirements, so a MexIFace library must be produced for each Matlab release that will be targeted.</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;## Quick scripts</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;* First, set `MATLAB_ROOTS` environment variable to list (&#39;;&#39; or &#39;:&#39; separated) of matlab root directories or a folder containing them.</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;~~~.sh</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;export MATLAB_ROOTS=/opt/matlab:$HOME/opt/matlab:...</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;~~~</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;**Native Linux build**</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;~~~.sh</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;./scripts/build.sh</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;export MATLABPATH=$(pwd)/_install/lib/MexIFace/matlab:$MATLABPATH</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;~~~</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;**Matlab `glnxa64 R2016b+:`** Linux `gcc-4.9.4` environment cross-compile.</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;~~~.sh</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;export X86_64_GCC4_9_LINUX_GNU_ROOT=...</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;./scripts/build.gcc4_9.sh</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;export MATLABPATH=$(pwd)/_gcc4_9.install/lib/MexIFace/matlab:$MATLABPATH</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;~~~</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;**Matlab `glnxa64 R2018a+:`** Linux `gcc-6.5.0` environment cross-compile.</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;~~~.sh</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;export X86_64_GCC6_5_LINUX_GNU_ROOT=...</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;./scripts/build.gcc6_5.sh</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;export MATLABPATH=$(pwd)/_gcc6_5.install/lib/MexIFace/matlab:$MATLABPATH</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;~~~</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;**Matlab `win64 R2016b+:`** Windows MXE-MexIFace `mingw-w64`/`gcc-4.9.4` environment cross-compile</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;~~~.sh</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;export MXE_ROOT=...</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;./scripts/build.wim64.sh</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;export MATLABPATH=$(pwd)/_win64.install/lib/MexIFace/matlab:$MATLABPATH</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;~~~</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;**Run Matlab unit tests on command line**</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;~~~.sh</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;matlab -nodesktop -r &quot;startupMexIFace();run(MexIFace.Test.TestMexIFace)&quot;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;~~~</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;**Setup MexIFace paths from inside matlab**</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;~~~.matlab</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;cd(&#39;install_dir/lib/MexIFace/matlab&#39;)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;startupMexIFace()</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;results = run(MexIFace.Test.TestMexIFace)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;~~~</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;&lt;!--MexIFace is designed to build from Linux to either Linux `glnxa64` or Windows `win64` Matlab environments.  The build system hides most of the details involved in the MEX building and linking process.--&gt;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;## Core Dependencies</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; * [Matlab](https://www.mathworks.com/) - Set environment variables `MATLAB_ROOT` or `MATLAB_ROOTS` to any directory containing Matlab roots.  A MexIFace library will be created for each supported release root found.</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; * BLAS and LAPACK 64-bit Integer ABI</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; * [*Armadillo*](http://arma.sourceforge.net/docs.html) - A high-performance array library for C++.</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;## Matlab and GCC Compatibility</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;In order to build for a particular Matlab target environment, the development machine must have system libraries and all relevant dependencies built with the correct version of GCC.</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; * [Matlab and MEX linking](doc/text/matlab-mex-linking.md) - More than you wanted to know about Matlab and MEX linking.</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;For C++, the most important restriction involves [`libsdtc++` versioning](https://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html), which prevents the use of a GCC with a `CXXABI` version newer than that used by the Matlab release targeted.  Currently the following GCC versions are supported for use with MexIFace.</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;| GCC Version | Compatible Matlab Releases |</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;--------------|----------------------------|</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;| gcc-4.9.4   | R2016b+ |</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;| gcc-6.5.0   | R2018a+ |</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; * MexIFace requires C++11 so releases prior to R2016b are not supported, as they require `gcc&lt;=4.7` which has an incomplete C++11 implementation.</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; * Compatibility for cross-compiling with `mingw-w64` for Windows targets is subject to the same GCC version restrictions.</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;## BLAS and LAPACK</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;The [BLAS](https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms) and [LAPACK](https://en.wikipedia.org/wiki/LAPACK) libraries are common numerical dependencies.  Matlab includes internal BLAS and LAPACK libraries that used 64-bit integers for array indexing.  Many commonly available BLAS and LAPACK implementations instead use an incompatible 32-bit integer ABI.  To make dual-use C++ and Matlab libraries it necessary to have system versions of the 64-bit BLAS and LAPACK.</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;* [MexIFace BLAS and LAPACK 64-bit Integer Setup](doc/text/mexiface-blas-and-lapack.md)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;### CMake general Variables and Options</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; * `OPT_MexIFace_MATLAB_INTERLEAVED_COMPLEX` - Enable interleaved complex API in R2018a+.</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; * `OPT_MexIFace_MATLAB_LARGE_ARRAY_DIMS` - Enable 64-bit array indexes in R2017a+.  If *BLAS* or *LAPACK* are used this needs to be on, as Matlab uses 64-bit indexes.</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; * `OPT_MexIFace_INSTALL_DISTRIBUTION_STARTUP`- Install an additional copy of startupPackage.m at the `INSTALL_PREFIX` root in addition to the normal directory.  This makes it easy to distribute as a binary archive file (.zip, .tar.gz, etc.).</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; * `OPT_MexIFace_PROFILE` - Built-in [gperftools](https://github.com/gperftools/gperftools) profiling `ProfileStart()`/`ProfileStop()` for every method call to a MexIFace object.</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; * `OPT_MexIFace_VERBOSE`  - Verbose output for MexIFace CMake configuration.</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; * `OPT_MexIFace_SILENT` - Silent output for MexIFace CMake configuration.  Warnings and errors only.</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; * `BUILD_TESTING` - Build testing framework</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; * `OPT_DOC` - Build documentation</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; * `OPT_INSTALL_TESTING` - Install testing executables</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; * `OPT_EXPORT_BUILD_TREE` - Configure the package so it is usable from the build tree.  Useful for development.</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; * `OPT_EXTRA_DEBUG` - Support extra noisy debugging features (Armadillo).</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;### Other Dependencies</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; * Documentation building with `OPT_DOC`</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    * [*Doxygen*](https://github.com/google/googletest)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    * [*graphviz*](https://www.graphviz.org/)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    * [*LaTeX*](https://www.latex-project.org/get/) - Required to generate pdf documenation (`make pdf`)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; * gentoo:</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;#### Git subrepo modules</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;These dependencies are included via the [`git subrepo`](https://github.com/ingydotnet/git-subrepo) mechanism, unlike `git submodule` there is not need to fetch subrepos in a seperate step after cloning.</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  * [UncommonCMakeModules](https://github.com/markjolah/BacktraceException) - Modules for package export automation, as well as toolchain files for Matlab cross-compile builds.</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  * [ci-numerical-dependencies](https://github.com/markjolah/ci-numerical-dependencies) - Scripts for installing Armadillo, BLAS and LAPACK with 64-bit integer support on TravisCI or Ubuntu/Debian systems.</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;#### External Projects</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;These packages are specialized CMake projects.  If they are not currently installed on the development machines we use the [AddExternalDependency.cmake](https://github.com/markjolah/UncommonCMakeModules/blob/master/AddExternalDependency.cmake) module which will automatically download, configure, build and install the CMake-based dependency to the `CMAKE_INSTALL_PREFIX`.  The dependency can then be found through the normal CMake `find_package()` system.</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;* [BacktraceException](https://github.com/markjolah/BacktraceException) - An library that allows Debug builds to get a stack backtrace when an exception derived from [`BacktraceException`]() is called. MexIFace translates `BacktraceException` exceptions into calls to Matlab&#39;s `mexErrMsgIdAndTxt` mechanism allowing very useful debugging output for tracing down errant exceptions.  Often this provides enough information to isolate bugs without attaching a debugger to the Matlab process.</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;#### Getting a linkable Matlab stub environment</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  Because Matlab is closed-source we cannot provide the actual Matlab libraries necessary to link the MexIFace library.</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  If you do have one or more valid releases of Matlab, and you would like to build or test build in an environment with no valid Matlab license, you can use what we call a linkable-stub Matlab environment.  The result is archives `matlab_stub-ARCH-VERS.tar.bz2` for each find-able &lt;atlab root under the given search paths:</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    &gt; ./scripts/create-matlab-linker-stub.py --outdir &lt;outdir&gt; &lt;matlab_root_search_paths...&gt;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;## LICENSE</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;* Copyright: 2013-2019</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;* Author: Mark J. Olah</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;* Email: (mjo@cs.unm DOT edu)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;* LICENSE: Apache 2.0.  See [LICENSE](https://github.com/markjolah/MexIFace/blob/master/LICENSE) file.</div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
